"use strict";angular.module("Login",["Authentication","MainComponents","GlobalVarsSrvs","pascalprecht.translate"]).controller("LoginController",["$scope","$http","$rootScope","$location","$cookies","$cookieStore","AuthenticationService","jwtHelper","store","globalVarsSrv",function(o,e,r,t,l,n,a,i,s,u){o.errorString="Εισάγετε τα στοιχεία σας για να συνδεθείτε!",o.login=function(){o.errorString=null,u.setGlobalVar("menuRole","public"),u.setGlobalVar("appLoggedIn",!1),a.Login(o.usr,o.pswd,function(e){if("fail"===e)return void(r.globals={item:null});if(401===e.status)return o.errorString="Λάθος Στοιχεία Σύνδεσης! Προσπαθήστε ΞΑΝΑ!",void(r.globals={item:null});var l=e.data.token,n=i.decodeToken(l);u.setGlobalVar("token",n),u.appInit("appConfig",n.sub,function(){for(var o=0;o<n.roles[0].roles.length;o++)if("admin"===n.roles[0].roles[o].role)return u.setGlobalVar("menuRole","admin"),void t.path("/home");u.getGlobalVar("menuRole")||u.setGlobalVar("menuRole","user"),u.setGlobalVar("appLoggedIn",!0),t.path("/dashboard")})})},o.unAuthUser=function(){t.path("/roombook")}}]);