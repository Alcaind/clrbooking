"use strict";angular.module("MainComponents",["Authentication","ui.bootstrap","GlobalVarsSrvs"]).controller("MainComponentsController",["$scope","$interval","$rootScope","$location",function(e,t,o,n){}]).controller("NavmenuController",["$scope","$interval","AuthenticationService","globalVarsSrv","$location","api","$routeParams","$translate",function(e,t,o,n,i,r,l,a){function s(t,o){if(!t)return void(e.adminColums=[]);var i=n.getGlobalVar("menuRole");e.adminColums=n.getGlobalVar("menuRole")?n.getGlobalVar("admin"===i?"homeButtonAdminTableConf":null===i?"":"homeButtonUserTableConf"):[]}n.getGlobalVar("appStarted")&&n.getGlobalVar("menuRole")&&s(),n.addListener("appStarted",s),n.addListener("appLoggedIn",s),n.addListener("menuRole",s),e.toggleDropdown=function(t){t.preventDefault(),t.stopPropagation(),e.status.isopen=!e.status.isopen},e.getProfile=function(){var t=n.getGlobalVar("auth");e.curUser=t.authdata.roles[0].id,i.path("/users/"+e.curUser)},e.logout=function(){o.ClearCredentials()},e.closeWithCookie=function(){n.cookieSave()},e.updateLanguage=function(e){a.use(e),n.setGlobalVar("lang",e),n.cookieSave()},e.refreshClear=function(){localStorage.clear()}}]).factory("MakeModal",["$uibModal",function(e){var t={};return t.defaultModal=function(t,o,n,i,r){var l=e.open({templateUrl:"modules/mainComponents/views/popup.html",controller:"PopupController",scope:i,size:t});return l.result.then(o,n),l},t.guestModal=function(t,o,n,i,r,l,a,s){var c=e.open({templateUrl:t,controller:"guestModalController",size:o||"sm",resolve:{config:function(){return{title:i,data:r,type:n,buttons:l,size:o}}}});return c.result.then(a,s),c},t.generalInfoModal=function(t,o,n,i,r,l,a){var s=e.open({templateUrl:"modules/mainComponents/views/genpopup.html",controller:"gneralInfoPopupController",size:t||"sm",resolve:{config:function(){return{title:n,message:i,type:o,buttons:r,size:t}}}});return s.result.then(l,a),s},t.generalModal=function(t,o,n,i,r,l,a,s){var c=e.open({templateUrl:t,controller:"generalModalController",size:o||"sm",resolve:{config:function(){return{title:i,data:r,type:n,buttons:l,size:o}}}});return c.result.then(a,s),c},t.infoBookRoom=function(t,o,n){var i=e.open({templateUrl:"modules/mainComponents/views/infoFormPopUp.html",controller:"infoFormPopUpController",size:"lg",resolve:{config:function(){return{reqID:t}}}});return i.result.then(o,n),i},t}]).controller("PopupController",["$scope","$uibModalInstance",function(e,t){e.ok=function(){t.close("ok")},e.cancel=function(){t.dismiss("cancel")}}]).controller("gneralInfoPopupController",["$scope","$uibModalInstance","config",function(e,t,o){e.title=o.title?o.title:"Info",e.modalMessage=o.message?o.message:"message",e.type=o.type?o.type:"info",e.buttons=o.buttons?o.buttons:1,e.ok=function(){t.close("ok")},e.cancel=function(){t.dismiss("cancel")}}]).controller("generalModalController",["$scope","$uibModalInstance","config",function(e,t,o){e.title=o.title?o.title:"Info",e.data=o.data,e.buttons=o.buttons?o.buttons:1,e.ok=function(){t.close(e.data)},e.cancel=function(){t.dismiss("cancel")}}]).directive("backButton",function(){return{restrict:"A",link:function(e,t,o){function n(){history.back(),e.$apply()}t.bind("click",n)}}}).controller("PaginationController",["$scope",function(e){e.pageThresholds=[{th:1},{th:3},{th:5},{th:10},{th:20},{th:50},{th:"all"}],e.currentPage=1,e.maxSize=5,e.itemsPerPage=10,e.$watch("totalItems",function(t,o){e.itemsPerPage=t}),e.numPages=e.totalItems/e.itemsPerPage,e.setPage=function(t){e.currentPage=t},e.setItemsPerPage=function(t){e.itemsPerPage="all"===t?e.totalItems:t,e.currentPage=1,e.numPages=e.totalItems/e.itemsPerPage}}]).controller("showHideOptionsController",["$scope",function(e){e.optionsVisible=!1,e.hideShowOptions=function(){e.optionsVisible=!e.optionsVisible},e.changeColumnVisibility=function(e,t){e.visible=t||!e.visible}}]).directive("showHide",function(e){function t(e,t,o){e.collapsed=!0,e.title=o.shTitle,e.toggle=function(t){t.preventDefault(),e.collapsed=!e.collapsed},e.$watch("sh",function(t,o){t||(e.collapsed=!0)})}return{scope:{sh:"="},restrict:"E",transclude:!0,templateUrl:"modules/mainComponents/views/showHide.html",link:t}}).controller("configController",["$scope","api","$location",function(e,t,o){function n(e,t){return Math.ceil(Math.abs(new Date(e)-new Date(t))/864e5)}e.configuration={},e.year||(e.year="1"),e.init=function(){t.apiCall("GET","api/public/config/"+e.year,function(t){e.configuration=t.data,e.configuration.s=!1,e.configuration.totalDays=n(e.configuration.tod,e.configuration.fromd);for(var o=0;o<e.configuration.periods.length;o++)e.configuration.periods[o].totalDays=n(e.configuration.periods[o].tod,e.configuration.periods[o].fromd),e.configuration.periods[o].fdIndex=n(e.configuration.fromd,e.configuration.periods[o].fromd),e.configuration.periods[o].tdIndex=e.configuration.periods[o].fdIndex+e.configuration.periods[o].totalDays,e.configuration.periods[o].s=!1})},e.setPeriod=function(t){!0===e.periodsActive?0!==t.status&&(e.selectedPeriod.s=!1,t.s=!0,e.selectedPeriod=t):(e.selectedPeriod.s=!1,t.s=!0,e.selectedPeriod=t)},e.$watch("year",function(t){e.init()})}]).directive("configBookGraph",function(){return{restrict:"EA",scope:{selectedPeriod:"=",year:"=",periodsActive:"="},controller:"configController",templateUrl:"modules/mainComponents/config/configGraph.html"}}).directive("fromToDatePicker",function(){return{restrict:"EA",scope:{fromd:"=",tod:"="},templateUrl:"modules/mainComponents/views/datetime/fromtodate.html"}}).directive("fromToTimePicker",function(){return{restrict:"EA",scope:{fromt:"=",tot:"="},templateUrl:"modules/mainComponents/views/datetime/fromtotime.html"}}).directive("ifLoading",function(e){return{restrict:"A",link:function(t,o){function n(e){e?o.show():o.hide()}function i(){return e.pendingRequests.length>0}t.isLoading=i,t.$watch(t.isLoading,n)}}}).directive("testTransclude",function(){return{restrict:"E",transclude:!0,templateUrl:"modules/mainComponents/views/showHide.html"}}).directive("navmenu",function(){return{restrict:"EA",controller:"NavmenuController",templateUrl:"modules/mainComponents/views/navmenu.html"}}).directive("deleteRowButton",function(){return{restrict:"EA",templateUrl:"modules/mainComponents/views/deleteRowButton.html"}}).directive("dmTitle",function(){return{restrict:"EA",templateUrl:"modules/mainComponents/views/dmTitle.html"}}).directive("tableTools",function(){return{restrict:"EA",templateUrl:"modules/mainComponents/views/tableTools.html"}}).directive("operations",function(){return{restrict:"EA",scope:{hr:"@",content:"@",gicon:"@",place:"@",item:"<"},templateUrl:"modules/mainComponents/views/buttonPopUp.html"}}).directive("dmTh",function(){return{restrict:"EA",templateUrl:"modules/mainComponents/views/dmth.html"}}).directive("toggle",function(){return{restrict:"A",link:function(e,t,o){"tooltip"==o.toggle&&$(t).tooltip(),"popover"==o.toggle&&$(t).popover()}}}).directive("footer",function(){return{restrict:"EA",templateUrl:"modules/mainComponents/views/footer.html"}}).directive("pagination",function(){return{restrict:"EA",scope:{currentPage:"=",totalItems:"=",itemsPerPage:"=",numPages:"="},templateUrl:"modules/mainComponents/views/pagination.html",controller:"PaginationController"}}).directive("showHideColumns",function(){return{restrict:"EA",scope:{columsVisibility:"="},templateUrl:"modules/mainComponents/views/showHideColumns.html",controller:"showHideOptionsController"}});